<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>DruidConnection</title>
    
<style id="wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '寰蒋闆呴粦', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1rem;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;height:auto !important;margin:2px 0;}.wiz-editor-body table {border-collapse:collapse;border:1px solid #bbbbbb;}.wiz-editor-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse;border:1px solid #bbbbbb;min-height:28px;word-break:break-word;box-sizing: border-box;}.wiz-hide {display:none !important;}</style></head>

<body class="wiz-editor-body" spellcheck="false" ><div><span style="font-family: 'MV Boli'; line-height: 1;">import com.alibaba.druid.pool.DruidDataSourceFactory;</span><br></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">import javax.sql.DataSource;</font></div><div><font face="MV Boli">import java.io.IOException;</font></div><div><font face="MV Boli">import java.io.InputStream;</font></div><div><font face="MV Boli">import java.sql.Connection;</font></div><div><font face="MV Boli">import java.sql.SQLException;</font></div><div><font face="MV Boli">import java.util.Properties;</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">/**</font></div><div><font face="MV Boli">&nbsp;* Created by IntelliJ IDEA</font></div><div><font face="MV Boli">&nbsp;*</font></div><div><font face="MV Boli">&nbsp;* @author: admin</font></div><div><font face="MV Boli">&nbsp;* Date: 2018/7/30</font></div><div><font face="MV Boli">&nbsp;* Time: 18:52</font></div><div><font face="MV Boli">&nbsp;*/</font></div><div><font face="MV Boli">public class DruidConnection {</font></div><div><font face="MV Boli">&nbsp; &nbsp; private static Properties properties = null;</font></div><div><font face="MV Boli">&nbsp; &nbsp; private static DataSource dataSource = null;</font></div><div><font face="MV Boli">&nbsp; &nbsp; private volatile static DruidConnection instatce = null;</font></div><div><font face="MV Boli">&nbsp; &nbsp; private Connection connection = null;</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; //私有构造函数,防止实例化对象</font></div><div><font face="MV Boli">&nbsp; &nbsp; private DruidConnection() {</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; }</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; static {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; try {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; properties = new Properties();</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 1.加载properties文件</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InputStream is = DruidConnection.class.getClassLoader().getResourceAsStream("druid.properties");</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 2.加载输入流</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; properties.load(is);</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 3.获取数据源</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dataSource = getDatasource();</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; } catch (IOException e) {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace();</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font face="MV Boli">&nbsp; &nbsp; }</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; /**</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp;* 用简单单例模式确保只返回一个链接对象</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp;*</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp;* @return</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp;*/</font></div><div><font face="MV Boli">&nbsp; &nbsp; public static DruidConnection getInstace() {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; if(instatce == null) {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; synchronized (DruidConnection.class) {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(instatce == null) {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; instatce = new DruidConnection();</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; return instatce;</font></div><div><font face="MV Boli">&nbsp; &nbsp; }</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; // 返回一个数据源</font></div><div><font face="MV Boli">&nbsp; &nbsp; public DataSource getDataSource() {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; return dataSource;</font></div><div><font face="MV Boli">&nbsp; &nbsp; }</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; // 返回一个链接</font></div><div><font face="MV Boli">&nbsp; &nbsp; public Connection getConnection() {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; try {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; connection = dataSource.getConnection();</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; } catch (SQLException e) {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace();</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; return connection;</font></div><div><font face="MV Boli">&nbsp; &nbsp; }</font></div><div><font face="MV Boli"><br></font></div><div><font face="MV Boli">&nbsp; &nbsp; // 加载数据源</font></div><div><font face="MV Boli">&nbsp; &nbsp; private static DataSource getDatasource() {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; DataSource source = null;</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; try {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; source = DruidDataSourceFactory.createDataSource(properties);</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; } catch (Exception e) {</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace();</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; }</font></div><div><font face="MV Boli">&nbsp; &nbsp; &nbsp; &nbsp; return source;</font></div><div><font face="MV Boli">&nbsp; &nbsp; }</font></div><div><font face="MV Boli">}</font></div><div><font face="MV Boli"><br></font></div></body></html>