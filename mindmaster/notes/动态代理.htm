<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>动态代理</title>
    
<style id="wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '寰蒋闆呴粦', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1rem;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;height:auto !important;margin:2px 0;}.wiz-editor-body table {border-collapse:collapse;border:1px solid #bbbbbb;}.wiz-editor-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse;border:1px solid #bbbbbb;min-height:28px;word-break:break-word;box-sizing: border-box;}.wiz-hide {display:none !important;}</style></head>

<body class="wiz-editor-body" spellcheck="false" ><div><br class="Apple-interchange-newline"><img src="" style="font-family: 'MV Boli';"></div><div><span data-wiz-span="data-wiz-span">常用于框架</span></div><div><span data-wiz-span="data-wiz-span">静态代理：直接固定的创建一个类来增强某一个类的功能</span></div><div><span data-wiz-span="data-wiz-span">动态代理：在程序运行时，动态创建出一个类（Class对象）的对象，来增强某一个类的功能（没有.class的基础上动态的创</span><span><span data-wiz-span="data-wiz-span">建对象</span></span></div><div><br></div><div><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;"><b><span data-wiz-span="data-wiz-span">装饰设计模式</span></b></span></div><div><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;"><b><span data-wiz-span="data-wiz-span">动态代理<span><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp;</span></span></span><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp;</span><span><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp;</span></span></b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp;</span></span></div><div><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;"><span data-wiz-span="data-wiz-span">&nbsp;</span><span><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp;</span></span><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli'; color: rgb(255, 0, 0);">public static Object newProxyInstance(ClassLoader loader,</span></b></span></div><div><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;"><b><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Class&lt;?&gt;[] interfaces,</span></b></span></div><div><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;"><b><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InvocationHandler h)</span></b></span></div><div><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;"><br></span></div><div><blockquote><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span">public class ProxyMode{</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; public static void main(String[] args) {</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; Singer lb=new LiuBei();</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; //LiuBei lb=new LiuBei();</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; lb.sing(10);</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; lb.dance(10);</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; lb.eat();</span></b></span></div><div><span style="font-size:0.833rem;"><b><br></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; ClassLoader loader=lb.getClass().getClassLoader();</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; Class&lt;?&gt;[] interfaces=lb.getClass().getInterfaces();</span></b></span></div><div><span style="font-size:0.833rem;"><b><br></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; // InvocationHandler h=</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp;//创建动态代理对象</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; Singer proxySinger=(Singer) Proxy.newProxyInstance(loader,interfaces,new InvocationHandler() {</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @Override</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp;</span></span><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0); font-family: 'MV Boli';">&nbsp; public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ("sing".equals(method.getName())){</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int money=(int)args[0];//为何要强转？？？？</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (money&gt;100){</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println("接受！");</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return method.invoke(lb,args);</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }else{</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println("不接受");</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return null;</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></b></span></div><div><span style="font-size:0.833rem;"><b><br></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ("dance".equals(method.getName())){</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int money=(int)args[0];//为何要强转？？？？</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (money&gt;100){</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println("接受！");</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return method.invoke(lb,args);</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }else{</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println("拒绝");</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return null;</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return method.invoke(lb,args);</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; });</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; proxySinger.sing(130);</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; proxySinger.dance(50);</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; &nbsp; &nbsp; proxySinger.eat();</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">&nbsp; &nbsp; }</span></b></span></div><div><span style="font-size:0.833rem;"><b><span data-wiz-span="data-wiz-span" style="font-family: 'MV Boli';">}</span></b></span></div></blockquote><div><br></div><br class="Apple-interchange-newline"><br></div></body></html>